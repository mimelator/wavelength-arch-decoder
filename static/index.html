<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wavelength Architecture Decoder</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <h1>üåä Wavelength</h1>
                <span class="subtitle">Architecture Decoder</span>
            </div>
            <ul class="nav-menu">
                <li><a href="#dashboard" class="nav-link active" data-page="dashboard">Dashboard</a></li>
                <li><a href="#repositories" class="nav-link" data-page="repositories">Repositories</a></li>
                <li><a href="#graph" class="nav-link" data-page="graph">Graph</a></li>
                <li><a href="#search" class="nav-link" data-page="search">Search</a></li>
                <li>
                    <button id="theme-toggle" class="theme-toggle" title="Toggle dark/light theme">
                        <span id="theme-icon">üåô</span>
                    </button>
                </li>
            </ul>
        </div>
    </nav>

    <main class="main-content">
        <!-- Dashboard Page -->
        <div id="dashboard" class="page active">
            <div class="page-header">
                <h2>Dashboard</h2>
                <p>Overview of your architecture analysis</p>
            </div>
            <div class="dashboard-grid">
                <div class="stat-card" data-entity-type="repositories">
                    <h3 id="stat-repositories">0</h3>
                    <p>Repositories</p>
                </div>
                <div class="stat-card" data-entity-type="dependencies">
                    <h3 id="stat-dependencies">0</h3>
                    <p>Dependencies</p>
                </div>
                <div class="stat-card" data-entity-type="services">
                    <h3 id="stat-services">0</h3>
                    <p>Services</p>
                </div>
                <div class="stat-card" data-entity-type="security">
                    <h3 id="stat-security">0</h3>
                    <p>Security Entities</p>
                </div>
            </div>
            <div class="dashboard-section">
                <h3>Recent Repositories</h3>
                <div id="recent-repos" class="repo-list"></div>
            </div>
            <div class="dashboard-section">
                <h3>AI Assistant</h3>
                <div class="info-card" style="background: linear-gradient(135deg, var(--primary-color) 0%, #1e40af 100%); color: white; padding: 1.5rem; border-radius: 0.5rem; margin-bottom: 1.5rem;">
                    <div style="display: flex; align-items: start; gap: 1rem;">
                        <div style="font-size: 2rem;">ü§ñ</div>
                        <div style="flex: 1;">
                            <h4 style="margin: 0 0 0.5rem 0; color: white;">Interactive AI Assistant</h4>
                            <p style="margin: 0 0 1rem 0; opacity: 0.95;">Ask natural language questions about your codebase architecture, dependencies, services, and code relationships.</p>
                            <div style="background: rgba(255, 255, 255, 0.15); padding: 1rem; border-radius: 0.375rem; margin-bottom: 1rem;">
                                <strong style="display: block; margin-bottom: 0.5rem;">To launch the AI Assistant:</strong>
                                <ol style="margin: 0; padding-left: 1.5rem; opacity: 0.95;">
                                    <li style="margin-bottom: 0.5rem;">Open a terminal in the project root</li>
                                    <li style="margin-bottom: 0.5rem;">Navigate to the AI assistant directory: <code style="background: rgba(0,0,0,0.2); padding: 0.125rem 0.375rem; border-radius: 0.25rem;">cd ai-assistant</code></li>
                                    <li style="margin-bottom: 0.5rem;">Start the assistant: <code style="background: rgba(0,0,0,0.2); padding: 0.125rem 0.375rem; border-radius: 0.25rem;">./start.sh</code> (or <code style="background: rgba(0,0,0,0.2); padding: 0.125rem 0.375rem; border-radius: 0.25rem;">uvicorn src.main:app --reload --port 8000</code>)</li>
                                    <li>Open <a href="http://localhost:8000" target="_blank" style="color: white; text-decoration: underline; font-weight: 600;">http://localhost:8000</a> in your browser</li>
                                </ol>
                            </div>
                            <div style="display: flex; gap: 0.75rem; flex-wrap: wrap;">
                                <a href="http://localhost:8000" target="_blank" class="btn" style="background: white; color: var(--primary-color); border: none; font-weight: 600;">
                                    üöÄ Open AI Assistant
                                </a>
                                <a href="https://github.com/mimelator/wavelength-arch-decoder/blob/main/ai-assistant/README.md" target="_blank" class="btn" style="background: rgba(255, 255, 255, 0.2); color: white; border: 1px solid rgba(255, 255, 255, 0.3);">
                                    üìñ View Documentation
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Repositories Page -->
        <div id="repositories" class="page">
            <div class="page-header">
                <h2>Repositories</h2>
                <button class="btn btn-primary" id="btn-add-repo">Add Repository</button>
            </div>
            <div class="repo-filters">
                <input type="text" id="repo-search" placeholder="Search repositories..." class="search-input">
            </div>
            <div id="repositories-list" class="repo-list"></div>
        </div>

        <!-- Repository Detail Page -->
        <div id="repository-detail" class="page">
            <div class="page-header">
                <button class="btn btn-secondary" id="btn-back-repos" onclick="history.back()">‚Üê Back</button>
                <h2 id="repo-detail-name">Repository Details</h2>
            </div>
            <div class="repo-detail-container">
                <div class="repo-detail-header">
                    <div class="repo-detail-info">
                        <h3 id="repo-detail-title">Loading...</h3>
                        <p id="repo-detail-url" class="repo-url"></p>
                        <div class="repo-detail-meta">
                            <span id="repo-detail-branch"></span>
                            <span id="repo-detail-last-analyzed"></span>
                        </div>
                    </div>
                    <div class="repo-detail-actions">
                        <div class="analyze-button-group">
                            <button class="btn btn-primary" id="btn-analyze-detail">Analyze</button>
                            <small class="analyze-info-text">‚ö†Ô∏è Monitor progress in server logs</small>
                        </div>
                        <button class="btn btn-secondary" id="btn-generate-report">üìÑ Generate Report</button>
                        <button class="btn btn-danger" id="btn-delete-detail">Delete</button>
                    </div>
                </div>
                <div id="analysis-status-detail" class="analysis-status" style="display: none;"></div>
                <div class="repo-detail-tabs">
                    <button class="repo-tab active" data-tab="overview">Overview</button>
                    <button class="repo-tab" data-tab="dependencies" data-entity-type="dependencies">Dependencies</button>
                    <button class="repo-tab" data-tab="services" data-entity-type="services">Services</button>
                    <button class="repo-tab" data-tab="code" data-entity-type="code">Code Structure</button>
                    <button class="repo-tab" data-tab="security" data-entity-type="security">Security</button>
                    <button class="repo-tab" data-tab="tools" data-entity-type="tools">Tools</button>
                    <button class="repo-tab" data-tab="tests" data-entity-type="tests">Tests</button>
                    <button class="repo-tab" data-tab="documentation" data-entity-type="documentation">üìÑ Documentation</button>
                    <button class="repo-tab" data-tab="graph">Graph</button>
                </div>
                <div class="repo-detail-content">
                    <div id="tab-overview" class="repo-tab-content active">
                        <div class="detail-stats">
                            <div class="detail-stat-card" data-entity-type="dependencies">
                                <h4 id="stat-deps-count">0</h4>
                                <p>Dependencies</p>
                            </div>
                            <div class="detail-stat-card" data-entity-type="services">
                                <h4 id="stat-services-count">0</h4>
                                <p>Services</p>
                            </div>
                            <div class="detail-stat-card" data-entity-type="code">
                                <h4 id="stat-code-count">0</h4>
                                <p>Code Elements</p>
                            </div>
                            <div class="detail-stat-card" data-entity-type="security">
                                <h4 id="stat-security-count">0</h4>
                                <p>Security Entities</p>
                            </div>
                        </div>
                    </div>
                    <div id="tab-dependencies" class="repo-tab-content">
                        <div class="code-filters">
                            <div class="filter-row">
                                <input type="text" id="dependencies-search" placeholder="Search dependencies..." class="search-input" style="flex: 1;">
                                <select id="dependencies-group-by" class="select-input">
                                    <option value="package_manager">Group by Package Manager</option>
                                    <option value="type">Group by Type</option>
                                    <option value="file">Group by File</option>
                                    <option value="none">No Grouping</option>
                                </select>
                                <select id="dependencies-filter-package-manager" class="select-input">
                                    <option value="">All Package Managers</option>
                                </select>
                                <select id="dependencies-filter-type" class="select-input">
                                    <option value="">All Types</option>
                                    <option value="dev">Dev Dependencies</option>
                                    <option value="prod">Production Dependencies</option>
                                </select>
                            </div>
                            <div class="filter-info" id="dependencies-filter-info"></div>
                        </div>
                        <div id="dependencies-list" class="detail-list">
                            <p class="loading-text">Loading dependencies...</p>
                        </div>
                    </div>
                    <div id="tab-services" class="repo-tab-content">
                        <div class="code-filters">
                            <div class="filter-row">
                                <input type="text" id="services-search" placeholder="Search services..." class="search-input" style="flex: 1;">
                                <select id="services-group-by" class="select-input">
                                    <option value="provider">Group by Provider</option>
                                    <option value="type">Group by Type</option>
                                    <option value="file">Group by File</option>
                                    <option value="none">No Grouping</option>
                                </select>
                                <select id="services-filter-provider" class="select-input">
                                    <option value="">All Providers</option>
                                </select>
                                <select id="services-filter-type" class="select-input">
                                    <option value="">All Types</option>
                                </select>
                            </div>
                            <div class="filter-info" id="services-filter-info"></div>
                        </div>
                        <div id="services-list" class="detail-list">
                            <p class="loading-text">Loading services...</p>
                        </div>
                    </div>
                    <div id="tab-code" class="repo-tab-content">
                        <div class="code-filters">
                            <div class="filter-row">
                                <input type="text" id="code-search" placeholder="Search code elements..." class="search-input" style="flex: 1;">
                                <select id="code-group-by" class="select-input">
                                    <option value="type">Group by Type</option>
                                    <option value="language">Group by Language</option>
                                    <option value="file">Group by File</option>
                                    <option value="none">No Grouping</option>
                                </select>
                                <select id="code-filter-type" class="select-input">
                                    <option value="">All Types</option>
                                </select>
                                <select id="code-filter-language" class="select-input">
                                    <option value="">All Languages</option>
                                </select>
                            </div>
                            <div class="filter-info" id="code-filter-info"></div>
                        </div>
                        <div id="code-list" class="detail-list">
                            <p class="loading-text">Loading code structure...</p>
                        </div>
                    </div>
                    <div id="tab-security" class="repo-tab-content">
                        <div class="code-filters">
                            <div class="filter-row">
                                <input type="text" id="security-search" placeholder="Search security entities..." class="search-input" style="flex: 1;">
                                <select id="security-group-by" class="select-input">
                                    <option value="type">Group by Type</option>
                                    <option value="provider">Group by Provider</option>
                                    <option value="file">Group by File</option>
                                    <option value="severity">Group by Severity</option>
                                    <option value="none">No Grouping</option>
                                </select>
                                <select id="security-filter-type" class="select-input">
                                    <option value="">All Types</option>
                                </select>
                                <select id="security-filter-provider" class="select-input">
                                    <option value="">All Providers</option>
                                </select>
                                <select id="security-filter-severity" class="select-input">
                                    <option value="">All Severities</option>
                                    <option value="critical">Critical</option>
                                    <option value="high">High</option>
                                    <option value="medium">Medium</option>
                                    <option value="low">Low</option>
                                </select>
                            </div>
                            <div class="filter-info" id="security-filter-info"></div>
                        </div>
                        <div id="security-list" class="detail-list">
                            <p class="loading-text">Loading security information...</p>
                        </div>
                    </div>
                    <div id="tab-tools" class="repo-tab-content">
                        <div class="code-filters">
                            <div class="filter-row">
                                <input type="text" id="tools-search" placeholder="Search tools..." class="search-input" style="flex: 1;">
                                <select id="tools-category-filter" class="select-input">
                                    <option value="">All Categories</option>
                                    <option value="build">Build Tools</option>
                                    <option value="test">Test Frameworks</option>
                                    <option value="lint">Linters</option>
                                    <option value="format">Formatters</option>
                                    <option value="deploy">Deployment</option>
                                    <option value="monitor">Monitoring</option>
                                    <option value="script">Scripts</option>
                                    <option value="other">Other</option>
                                </select>
                                <select id="tools-type-filter" class="select-input">
                                    <option value="">All Types</option>
                                    <option value="package_script">Package Scripts</option>
                                    <option value="config_file">Config Files</option>
                                    <option value="dev_dependency">Dev Dependencies</option>
                                    <option value="executable">Executables</option>
                                    <option value="environment">Environment</option>
                                </select>
                            </div>
                            <div class="filter-info" id="tools-filter-info"></div>
                        </div>
                        <div id="tools-list" class="detail-list">
                            <p class="loading-text">Loading tools...</p>
                        </div>
                    </div>
                    <div id="tab-tests" class="repo-tab-content">
                        <div class="code-filters">
                            <div class="filter-row">
                                <input type="text" id="tests-search" placeholder="Search tests..." class="search-input" style="flex: 1;">
                                <select id="tests-framework-filter" class="select-input">
                                    <option value="">All Frameworks</option>
                                    <option value="jest">Jest</option>
                                    <option value="mocha">Mocha</option>
                                    <option value="vitest">Vitest</option>
                                    <option value="pytest">Pytest</option>
                                    <option value="unittest">Unittest</option>
                                    <option value="cargo-test">Cargo Test</option>
                                    <option value="go-test">Go Test</option>
                                    <option value="junit">JUnit</option>
                                    <option value="testng">TestNG</option>
                                    <option value="xctest">XCTest</option>
                                    <option value="quick">Quick</option>
                                </select>
                                <select id="tests-language-filter" class="select-input">
                                    <option value="">All Languages</option>
                                    <option value="javascript">JavaScript</option>
                                    <option value="typescript">TypeScript</option>
                                    <option value="python">Python</option>
                                    <option value="rust">Rust</option>
                                    <option value="go">Go</option>
                                    <option value="java">Java</option>
                                    <option value="swift">Swift</option>
                                </select>
                            </div>
                            <div class="filter-info" id="tests-filter-info"></div>
                        </div>
                        <div id="tests-list" class="detail-list">
                            <p class="loading-text">Loading tests...</p>
                        </div>
                    </div>
                    <div id="tab-documentation" class="repo-tab-content">
                        <div class="code-filters">
                            <div class="filter-row">
                                <input type="text" id="documentation-search" placeholder="Search documentation..." class="search-input" style="flex: 1;">
                                <select id="documentation-type-filter" class="select-input">
                                    <option value="">All Types</option>
                                    <option value="Readme">README</option>
                                    <option value="Contributing">Contributing</option>
                                    <option value="Changelog">Changelog</option>
                                    <option value="License">License</option>
                                    <option value="ApiDocs">API Docs</option>
                                    <option value="Architecture">Architecture</option>
                                    <option value="Setup">Setup</option>
                                    <option value="Tutorial">Tutorial</option>
                                    <option value="Reference">Reference</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div class="filter-info" id="documentation-filter-info"></div>
                        </div>
                        <div id="documentation-list" class="detail-list">
                            <p class="loading-text">Loading documentation...</p>
                        </div>
                    </div>
                    <div id="tab-graph" class="repo-tab-content">
                        <div class="graph-controls">
                            <div class="graph-legend">
                                <h4>Node Types</h4>
                                <div class="graph-legend-items">
                                    <label class="graph-legend-item">
                                        <input type="checkbox" class="node-type-toggle" data-node-type="repository" checked>
                                        <span class="graph-legend-color" style="background: var(--entity-repository, #f59e0b);"></span>
                                        <span>Repositories</span>
                                    </label>
                                    <label class="graph-legend-item">
                                        <input type="checkbox" class="node-type-toggle" data-node-type="dependency" checked>
                                        <span class="graph-legend-color" style="background: var(--entity-dependency, #3b82f6);"></span>
                                        <span>Dependencies</span>
                                    </label>
                                    <label class="graph-legend-item">
                                        <input type="checkbox" class="node-type-toggle" data-node-type="service" checked>
                                        <span class="graph-legend-color" style="background: var(--entity-service, #10b981);"></span>
                                        <span>Services</span>
                                    </label>
                                    <label class="graph-legend-item">
                                        <input type="checkbox" class="node-type-toggle" data-node-type="code">
                                        <span class="graph-legend-color" style="background: var(--entity-code, #8b5cf6);"></span>
                                        <span>Code Elements</span>
                                    </label>
                                    <label class="graph-legend-item">
                                        <input type="checkbox" class="node-type-toggle" data-node-type="security" checked>
                                        <span class="graph-legend-color" style="background: var(--entity-security, #ef4444);"></span>
                                        <span>Security</span>
                                    </label>
                                    <label class="graph-legend-item">
                                        <input type="checkbox" class="node-type-toggle" data-node-type="test">
                                        <span class="graph-legend-color" style="background: var(--entity-test, #ec4899);"></span>
                                        <span>Tests</span>
                                    </label>
                                    <label class="graph-legend-item">
                                        <input type="checkbox" class="node-type-toggle" data-node-type="test_framework">
                                        <span class="graph-legend-color" style="background: var(--entity-test-framework, #f472b6);"></span>
                                        <span>Test Frameworks</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div id="repo-graph-container" class="graph-container">
                            <p class="loading-text">Loading graph...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Graph Visualization Page -->
        <div id="graph" class="page">
            <div class="page-header">
                <h2>Knowledge Graph</h2>
                <div class="graph-controls">
                    <select id="graph-repo-select" class="select-input">
                        <option value="">Select Repository</option>
                    </select>
                    <button class="btn btn-secondary" id="btn-load-graph">Load Graph</button>
                </div>
            </div>
            <div id="graph-container" class="graph-container">
                <div class="graph-placeholder">
                    <p>Select a repository to visualize its knowledge graph</p>
                </div>
            </div>
            <div id="graph-info" class="graph-info"></div>
        </div>

        <!-- Search Page -->
        <div id="search" class="page">
            <div class="page-header">
                <h2>Search</h2>
            </div>
            <div class="search-container">
                <div class="search-box">
                    <input type="text" id="search-query" placeholder="Search dependencies, services, code elements..." class="search-input-large">
                    <button class="btn btn-primary" id="btn-search">Search</button>
                </div>
                <div class="search-filters">
                    <label>
                        <input type="checkbox" id="filter-dependencies" checked> Dependencies
                    </label>
                    <label>
                        <input type="checkbox" id="filter-services" checked> Services
                    </label>
                    <label>
                        <input type="checkbox" id="filter-code" checked> Code Elements
                    </label>
                    <label>
                        <input type="checkbox" id="filter-security" checked> Security
                    </label>
                </div>
                <div id="search-results" class="search-results"></div>
            </div>
        </div>


    </main>

    <!-- Add Repository Modal -->
    <div id="modal-add-repo" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h2>Add Repository</h2>
            <form id="form-add-repo">
                <div class="form-group">
                    <label for="repo-name">Name</label>
                    <input type="text" id="repo-name" required>
                </div>
                <div class="form-group">
                    <label for="repo-url">Repository URL</label>
                    <input type="text" id="repo-url" required placeholder="https://github.com/user/repo.git or file:///path/to/repo">
                    <small style="color: var(--text-secondary); font-size: 0.875rem; display: block; margin-top: 0.5rem;">
                        Enter a Git repository URL or local file path. Examples:<br>
                        <strong>Remote repositories:</strong><br>
                        ‚Ä¢ https://github.com/user/repo.git<br>
                        ‚Ä¢ https://gitlab.com/user/repo.git<br>
                        ‚Ä¢ git@github.com:user/repo.git (SSH)<br>
                        <strong>Local repositories:</strong><br>
                        ‚Ä¢ file:///path/to/local/repo (Unix/Mac: use 3 slashes)<br>
                        ‚Ä¢ file:///C:/path/to/local/repo (Windows: use 3 slashes with drive letter)<br>
                        ‚Ä¢ file:///Volumes/5bits/current/my-project (macOS example)
                    </small>
                </div>
                <div class="form-group">
                    <label for="repo-branch">Branch</label>
                    <input type="text" id="repo-branch" value="main">
                </div>
                <div class="form-group">
                    <label for="repo-auth-type">Authentication (for private repos)</label>
                    <select id="repo-auth-type" class="select-input">
                        <option value="">None (public repository)</option>
                        <option value="token">Personal Access Token</option>
                        <option value="ssh_key">SSH Key Path</option>
                        <option value="username_password">Username/Password</option>
                    </select>
                    <small style="color: var(--text-secondary); font-size: 0.875rem; display: block; margin-top: 0.5rem;">
                        Select authentication method for private repositories
                    </small>
                </div>
                <div class="form-group" id="auth-value-group" style="display: none;">
                    <label for="repo-auth-value">Authentication Value</label>
                    <input type="text" id="repo-auth-value" placeholder="Token, SSH key path, or username:password">
                    <small style="color: var(--text-secondary); font-size: 0.875rem; display: block; margin-top: 0.5rem;">
                        <span id="auth-hint"></span>
                    </small>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary modal-close">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Repository</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Entity Detail Modal -->
    <div id="entity-detail-modal" class="modal" style="display: none;">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2 id="entity-detail-title">Entity Details</h2>
                <button class="modal-close-btn" onclick="closeEntityDetailModal()" aria-label="Close">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body" id="entity-detail-body">
                <p class="loading-text">Loading entity details...</p>
            </div>
        </div>
    </div>

    <script src="/static/js/api.js"></script>
    <script src="/static/js/app.js"></script>
    
    <footer class="app-footer">
        <div class="footer-content">
            <p>Wavelength Architecture Decoder <span id="app-version">v0.7.3</span></p>
            <p>
                <button id="btn-check-updates" class="btn-check-updates" title="Check for updates">üîÑ Check for Updates</button>
                <a href="https://hub.wavelengthlore.com/consulting-services" target="_blank" rel="noopener noreferrer">Wavelength Consulting</a>
            </p>
        </div>
    </footer>
</body>
</html>

